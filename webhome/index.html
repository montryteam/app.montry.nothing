<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lambo Search ‚Äî Nothing App</title>
    <script async src="https://cse.google.com/cse.js?cx=f015436e565c94c8d"></script>
    <style>
        :root {
            --bg: #191c21; 
            --fg: #ffffff;
            --surface: #252930; 
            --accent: #a4c8fc; 
            --radius: 28px;
            --shadow: 0 12px 40px rgba(0,0,0,0.5);
            --button-bg: var(--accent);
            --button-fg: #000;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
            background: var(--bg); 
            color: var(--fg); 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 16px;
            min-height: 100vh;
        }

        .logo { 
            font-weight: 900; 
            font-size: 42px; 
            letter-spacing: -1px;
            background: linear-gradient(135deg, var(--accent), #d1e3ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: logoIdle 6s ease-in-out infinite;
            padding: 10px 0;
        }

        @keyframes logoIdle { 0%, 100% { filter: drop-shadow(0 0 2px rgba(164,200,252,0.3)); } 50% { filter: drop-shadow(0 0 15px rgba(164,200,252,0.5)); } }
        @keyframes logoThink { 0% { filter: hue-rotate(0deg) brightness(1); } 50% { filter: hue-rotate(180deg) brightness(1.3); } 100% { filter: hue-rotate(360deg) brightness(1); } }

        .subtitle { color: #a8adb7; font-size: 14px; text-align: center; margin-top: -10px; }
        .byline { color: #6e7681; font-size: 12px; margin-bottom: 10px; }

        .card, .result { 
            width: 100%; 
            max-width: 440px; 
            background: var(--surface); 
            border-radius: var(--radius); 
            padding: 20px; 
            box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.05);
            transition: var(--transition);
        }

        .result { 
            height: auto; 
            min-height: 60px; 
            display: none; 
            animation: fadeIn 0.5s ease-out;
            overflow: hidden;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .row { display: flex; gap: 10px; width: 100%; }

        input[type="text"] { 
            flex: 1; 
            background: #111418; 
            color: var(--fg); 
            border-radius: 20px; 
            padding: 14px 20px; 
            border: 1px solid rgba(255,255,255,0.1);
            font-size: 16px;
            outline: none;
            transition: var(--transition);
        }

        input[type="text"]:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(164,200,252,0.15); }

        button.btn { 
            background: var(--button-bg); 
            color: var(--button-fg); 
            padding: 12px 22px; 
            border-radius: 20px; 
            border: 0; 
            font-weight: 800; 
            cursor: pointer; 
            transition: var(--transition);
            font-size: 14px;
        }

        button.btn:active { transform: scale(0.94); }

        .sectionTitle { 
            color: var(--accent); 
            font-weight: 800; 
            font-size: 12px; 
            text-transform: uppercase; 
            letter-spacing: 1.2px; 
            margin-bottom: 15px; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }
        
        .lamboText { 
            font-size: 16px; 
            line-height: 1.6; 
            color: #e1e4e8; 
            white-space: pre-wrap; 
            word-wrap: break-word;
        }

        .historyItem { 
            padding: 10px;
            margin-bottom: 6px;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            cursor: pointer; 
            font-size: 14px;
            transition: var(--transition);
        }
        .historyItem:hover { background: rgba(164,200,252,0.1); color: var(--accent); }

        .settingsFloat { 
            position: fixed; right: 24px; bottom: 24px; 
            width: 60px; height: 60px; border-radius: 22px; 
            background: var(--button-bg); color: var(--button-fg); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 26px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); 
            cursor: pointer; z-index: 60; transition: var(--transition);
        }
        .settingsFloat:hover { transform: rotate(30deg) scale(1.1); }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); display: none; align-items: center; justify-content: center; z-index: 70; }
        
        .settingsBox { 
            width: 90%; max-width: 400px; background: var(--surface); border-radius: 32px; 
            padding: 28px; display: flex; flex-direction: column; gap: 20px; 
            border: 1px solid rgba(255,255,255,0.1);
        }

        .typingCursor { display: inline-block; width: 8px; height: 18px; background: var(--accent); margin-left: 4px; animation: blink 0.8s infinite; vertical-align: middle; }
        @keyframes blink { 50% { opacity: 0; } }

    </style>
</head>
<body>

<div class="logo" id="logo">LAMBO</div>
<div class="subtitle">your friend & smart AI assistant üò∫</div>
<div class="byline">developed by <strong>Montry</strong> for <a href="https://montryteam.github.io/nothing/" target="_blank" style="color:var(--accent);text-decoration:none;font-weight:bold;">Nothing App</a></div>

<div class="card">
    <div class="row">
        <input id="q" type="text" placeholder="ask lambo or paste a URL... ‚ú®" />
        <button class="btn" id="goBtn">GO</button>
    </div>
    <div style="margin-top:12px; display:flex; gap:10px;">
        <button class="btn" id="micBtn" style="flex:1">üé§</button>
        <button class="btn" id="clearBtn" title="clear input" style="background:#333; color:#fff; width:50px;">‚úñ</button>
    </div>
</div>

<div class="result" id="lamboResult">
    <div class="sectionTitle">‚ú¶ LAMBO VIBE ‚Äî AI ANSWER</div>
    <div class="lamboText" id="lamboText">Lambo is chillin'... üòº <span class="typingCursor"></span></div>
</div>

<div class="result" id="googleResult">
    <div class="sectionTitle">üåê GOOGLE RESULTS</div>
    <div id="googleResultsContainer">
        <div class="gcse-search"></div>
    </div>
    <button class="btn" id="openGoogleBtn" style="margin-top:15px; width:100%;">Open Search üåê</button>
</div>

<div class="card">
    <div class="sectionTitle">HISTORY ‚è±Ô∏è</div>
    <div id="history" style="max-height: 120px; overflow-y: auto;">no history yet.</div>
</div>

<div class="settingsFloat" id="settingsBtn">‚öô</div>

<div class="overlay" id="overlay">
    <div class="settingsBox">
        <h2 style="font-size:20px; letter-spacing: -0.5px;">Settings ‚ö°</h2>
        <div>
            <div class="sectionTitle">Gemini API Key</div>
            <input id="apiKeyInput" type="text" placeholder="paste key here" style="width:100%"/>
        </div>
        <div>
            <div class="sectionTitle">Primary Color</div>
            <input id="btnColor" type="color" value="#a4c8fc" style="width:100%; height:45px; border-radius:12px; border:none; cursor:pointer"/>
        </div>
        <div style="display:flex; gap:10px;">
            <button class="btn" id="resetBtn" style="flex:1; background:#333; color:#fff">Reset Defaults</button>
            <button class="btn" id="saveSettingsBtn" style="flex:1">Save</button>
        </div>
        <button class="btn" id="closeSettingsBtn" style="background:transparent; color:#888; font-size:13px;">Close Window</button>
    </div>
</div>

<script>
    const APP_DEFAULTS = { 
        btnColor: '#a4c8fc', 
        bg: '#191c21' 
    };

    const LS = { apiKey:'LAMBO_KEY', btnColor:'LAMBO_COLOR', history:'LAMBO_HIST' };

    let API_KEY = localStorage.getItem(LS.apiKey) || '';
    let BTN_COLOR = localStorage.getItem(LS.btnColor) || APP_DEFAULTS.btnColor;
    let HISTORY = JSON.parse(localStorage.getItem(LS.history) || '[]');

    const qEl=document.getElementById('q'), goBtn=document.getElementById('goBtn'), lamboTextEl=document.getElementById('lamboText');
    const settingsBtn=document.getElementById('settingsBtn'), overlay=document.getElementById('overlay'), btnColorInput=document.getElementById('btnColor');

    document.getElementById('apiKeyInput').value = API_KEY;
    btnColorInput.value = BTN_COLOR;
    applyTheme(BTN_COLOR);
    renderHistory();

    goBtn.addEventListener('click', mainSearch);
    qEl.addEventListener('keydown', e => { if(e.key==='Enter') mainSearch(); });
    settingsBtn.addEventListener('click', () => overlay.style.display='flex');
    document.getElementById('closeSettingsBtn').addEventListener('click', () => overlay.style.display='none');
    document.getElementById('saveSettingsBtn').addEventListener('click', saveSettings);
    document.getElementById('resetBtn').addEventListener('click', resetToOriginal);
    document.getElementById('clearBtn').addEventListener('click', () => qEl.value='');

    function applyTheme(c) {
        document.documentElement.style.setProperty('--accent', c);
        document.documentElement.style.setProperty('--button-bg', c);
        const rgb = c.replace('#','');
        const r = parseInt(rgb.substring(0,2),16), g = parseInt(rgb.substring(2,4),16), b = parseInt(rgb.substring(4,6),16);
        const luminance = 0.2126*r + 0.7152*g + 0.0722*b;
        document.documentElement.style.setProperty('--button-fg', luminance > 160 ? '#000' : '#fff');
    }

    function saveSettings() {
        API_KEY = document.getElementById('apiKeyInput').value.trim();
        BTN_COLOR = btnColorInput.value;
        localStorage.setItem(LS.apiKey, API_KEY);
        localStorage.setItem(LS.btnColor, BTN_COLOR);
        applyTheme(BTN_COLOR);
        overlay.style.display = 'none';
        showToast('Settings Saved ‚ú®');
    }

    function resetToOriginal() {
        BTN_COLOR = APP_DEFAULTS.btnColor;
        btnColorInput.value = BTN_COLOR;
        localStorage.setItem(LS.btnColor, BTN_COLOR);
        applyTheme(BTN_COLOR);
        showToast('Reset to Original üîÅ');
    }

    async function mainSearch() {
        const query = qEl.value.trim();
        if(!query) return;

        if(/^https?:\/\//i.test(query) || (query.includes('.') && !query.includes(' '))) {
            window.location.href = query.startsWith('http') ? query : 'https://' + query;
            return;
        }

        saveToHistory(query);
        setLamboStatus(true);
        
        document.getElementById('lamboResult').style.display = 'block';
        document.getElementById('googleResult').style.display = 'block';
        
        await askLambo(query);
        setLamboStatus(false);
    }

    async function askLambo(query) {
        if(!API_KEY) {
            lamboTextEl.textContent = 'Add your API Key in Settings ‚öô';
            return;
        }
        lamboTextEl.textContent = 'Lambo is thinking...';
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: `You are Lambo, a friendly AI cat for Nothing App. Answer concisely: ${query}` }] }] })
            });
            const data = await response.json();
            const resultText = data?.candidates?.[0]?.content?.parts?.[0]?.text || 'No response from Lambo üòø';
            await streamText(lamboTextEl, resultText);
        } catch(e) {
            lamboTextEl.textContent = 'Connection error. Check your key üåê';
        }
    }

    function streamText(element, text) {
        return new Promise(resolve => {
            element.textContent = '';
            let index = 0;
            function nextChar() {
                if(index < text.length) {
                    element.textContent += text[index++];
                    setTimeout(nextChar, 15);
                } else resolve();
            }
            nextChar();
        });
    }

    function setLamboStatus(isThinking) {
        const logo = document.getElementById('logo');
        logo.style.animation = isThinking ? 'logoThink 2s infinite linear' : 'logoIdle 6s infinite';
    }

    function saveToHistory(q) {
        HISTORY.unshift({q, ts: Date.now()});
        if(HISTORY.length > 8) HISTORY.pop();
        localStorage.setItem(LS.history, JSON.stringify(HISTORY));
        renderHistory();
    }

    function renderHistory() {
        const hContainer = document.getElementById('history');
        if(HISTORY.length === 0) { hContainer.innerHTML = '<div style="color:#555">Empty</div>'; return; }
        hContainer.innerHTML = HISTORY.map(item => `<div class="historyItem" onclick="qEl.value='${item.q}';mainSearch();">${item.q}</div>`).join('');
    }

    function showToast(msg) {
        const t = document.createElement('div');
        t.textContent = msg;
        t.style = "position:fixed; bottom:100px; background:var(--accent); color:var(--button-fg); padding:12px 24px; border-radius:15px; font-weight:bold; box-shadow:0 10px 20px rgba(0,0,0,0.3); z-index:100;";
        document.body.appendChild(t);
        setTimeout(() => t.remove(), 2500);
    }
</script>
</body>
</html>
