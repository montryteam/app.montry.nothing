<!DOCTYPE html>
<html lang="en-CA" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lambo Search ‚Äî Nothing App</title>
    <script async src="https://cse.google.com/cse.js?cx=f015436e565c94c8d"></script>
    <style>
        :root {
            --bg: #191c21; 
            --fg: #ffffff;
            --surface: rgba(37, 41, 48, 0.7); 
            --accent: #a4c8fc; 
            --radius: 24px;
            --shadow: 0 12px 40px rgba(0,0,0,0.6);
            --button-bg: var(--accent);
            --button-fg: #000;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
            background: var(--bg); 
            color: var(--fg); 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 20px;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background 0.5s ease;
        }

        .mesh-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; display: none;
            background: linear-gradient(45deg, #191c21, #252930, #1a2a40, #2c3e50);
            background-size: 400% 400%;
            animation: meshAnim 15s infinite alternate;
        }
        @keyframes meshAnim { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

        .logo { 
            font-weight: 900; font-size: 45px; letter-spacing: -2px;
            background: linear-gradient(135deg, var(--accent), #fff);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            animation: logoPulse 4s infinite ease-in-out;
            cursor: default;
        }
        @keyframes logoPulse { 0%, 100% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.05); filter: brightness(1.2); } }

        .card, .result { 
            width: 100%; max-width: 450px; 
            background: var(--surface); 
            backdrop-filter: blur(20px);
            border-radius: var(--radius); padding: 20px; 
            box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,0.1);
        }

        .result { display: none; height: auto; animation: slideIn 0.5s ease forwards; overflow: hidden; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .shortcuts { display: flex; gap: 15px; justify-content: center; width: 100%; max-width: 450px; flex-wrap: wrap; }
        .tile { 
            width: 60px; height: 60px; border-radius: 18px; background: var(--surface);
            display: flex; align-items: center; justify-content: center; font-size: 22px;
            cursor: pointer; transition: var(--transition); border: 1px solid rgba(255,255,255,0.05);
        }
        .tile:hover { transform: translateY(-5px); background: var(--accent); color: #000; box-shadow: 0 5px 15px rgba(164,200,252,0.3); }

        .search-row { display: flex; gap: 10px; width: 100%; }
        input[type="text"], input[type="password"] { 
            flex: 1; background: rgba(0,0,0,0.3); color: #fff; 
            border-radius: 18px; padding: 15px; border: 1px solid rgba(255,255,255,0.1); 
            font-size: 16px; outline: none; transition: 0.3s;
        }
        input:focus { border-color: var(--accent); background: rgba(0,0,0,0.5); }

        button.btn { 
            background: var(--button-bg); color: var(--button-fg); 
            padding: 12px 25px; border-radius: 18px; border: 0; 
            font-weight: 800; cursor: pointer; transition: 0.3s;
        }
        button.btn:active { transform: scale(0.92); }

        .lamboText { font-size: 16px; line-height: 1.6; color: #f0f0f0; white-space: pre-wrap; }

        .history-card { 
            background: rgba(255,255,255,0.05); padding: 12px 16px; border-radius: 16px;
            margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;
            transition: 0.3s;
        }
        .history-card:hover { background: rgba(255,255,255,0.1); }

        .settingsFloat { 
            position: fixed; right: 25px; bottom: 25px; width: 60px; height: 60px; 
            border-radius: 20px; background: var(--accent); color: #000; 
            display: flex; align-items: center; justify-content: center; font-size: 26px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); cursor: pointer; z-index: 100;
        }

        .overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.85); 
            backdrop-filter: blur(15px); display: none; align-items: center; justify-content: center; z-index: 110; 
        }

        .settingsBox { 
            width: 90%; max-width: 400px; background: #252930; border-radius: 28px; 
            padding: 25px; display: flex; flex-direction: column; gap: 15px; border: 1px solid rgba(255,255,255,0.1);
        }

        .switch-row { display: flex; justify-content: space-between; align-items: center; }
        
        .typingCursor { display: inline-block; width: 8px; height: 18px; background: var(--accent); margin-left: 5px; animation: blink 1s infinite; vertical-align: middle; }
        @keyframes blink { 50% { opacity: 0; } }

    </style>
</head>
<body>

<div class="mesh-bg" id="meshBg"></div>

<div class="logo" id="logo">LAMBO</div>
<div style="color:#888; font-size:13px; margin-top:-15px;">Smart Assistant by Montry for Nothing App</div>

<div class="card">
    <div class="search-row">
        <input id="q" type="text" placeholder="Search or paste URL..." />
        <button class="btn" id="goBtn">GO</button>
    </div>
    <div style="margin-top:12px; display:flex; gap:10px;">
        <button class="btn" id="clearBtn" style="background:#333; color:#fff; flex:1">Clear</button>
        <button class="btn" id="summarizeBtn" style="display:none; flex:2; background:#fff; color:#000;">Summarize Link üìÑ</button>
    </div>
</div>

<div class="shortcuts">
    <div class="tile" onclick="window.location.href='https://www.google.ca'">G</div>
    <div class="tile" onclick="window.location.href='https://www.youtube.com'">Y</div>
    <div class="tile" onclick="window.location.href='https://www.reddit.com'">R</div>
    <div class="tile" onclick="window.location.href='https://github.com'">GH</div>
</div>

<div class="result" id="lamboResult">
    <div style="color:var(--accent); font-weight:800; font-size:11px; margin-bottom:10px; letter-spacing:1px;">‚ú¶ LAMBO AI</div>
    <div class="lamboText" id="lamboText">I'm here to help... <span class="typingCursor"></span></div>
</div>

<div class="result" id="googleResult">
    <div style="color:var(--accent); font-weight:800; font-size:11px; margin-bottom:10px; letter-spacing:1px;">üåê WEB RESULTS</div>
    <div id="googleResultsContainer" class="gcse-search"></div>
    <button class="btn" id="openGoogleBtn" style="width:100%; margin-top:10px; font-size:13px;">View more on Google</button>
</div>

<div class="card">
    <div style="font-weight:800; font-size:11px; margin-bottom:12px; color:var(--accent); letter-spacing:1px;">RECENT HISTORY ‚è±Ô∏è</div>
    <div id="history">No history yet.</div>
</div>

<div class="settingsFloat" id="settingsBtn">‚öô</div>

<div class="overlay" id="overlay">
    <div class="settingsBox">
        <h2 style="font-size:20px;">Settings ‚ö°</h2>
        
        <div>
            <label style="font-size:11px; display:block; margin-bottom:5px; color:#aaa;">GEMINI API KEY</label>
            <input id="apiKeyInput" type="password" placeholder="Paste your key..." style="width:100%"/>
        </div>

        <div class="switch-row">
            <span style="font-size:14px;">Live Mesh Background</span>
            <input type="checkbox" id="meshSwitch" style="width:18px; height:18px; cursor:pointer;">
        </div>

        <div>
            <label style="font-size:11px; display:block; margin-bottom:5px; color:#aaa;">ACCENT COLOR</label>
            <input id="btnColor" type="color" value="#a4c8fc" style="width:100%; height:40px; border:none; border-radius:10px; cursor:pointer"/>
        </div>

        <div style="display:flex; gap:10px; margin-top:10px;">
            <button class="btn" id="resetBtn" style="flex:1; background:#333; color:#fff">Reset</button>
            <button class="btn" id="saveSettingsBtn" style="flex:1">Save</button>
        </div>
        <button class="btn" id="closeSettingsBtn" style="background:transparent; color:#666; font-size:12px;">Close</button>
    </div>
</div>

<script>
    const DEFAULTS = { btnColor: '#a4c8fc', meshEnabled: false };
    const LS = { key: 'LAMBO_API', color: 'LAMBO_COLOR', mesh: 'LAMBO_MESH', hist: 'LAMBO_HIST' };

    let API_KEY = localStorage.getItem(LS.key) || '';
    let BTN_COLOR = localStorage.getItem(LS.color) || DEFAULTS.btnColor;
    let MESH_ENABLED = localStorage.getItem(LS.mesh) === 'true';
    let HISTORY = JSON.parse(localStorage.getItem(LS.hist) || '[]');

    const qEl=document.getElementById('q'), goBtn=document.getElementById('goBtn'), lamboTextEl=document.getElementById('lamboText');
    const meshBg=document.getElementById('meshBg'), meshSwitch=document.getElementById('meshSwitch');

    document.getElementById('apiKeyInput').value = API_KEY;
    document.getElementById('btnColor').value = BTN_COLOR;
    meshSwitch.checked = MESH_ENABLED;
    
    updateTheme();
    renderHistory();

    goBtn.addEventListener('click', performSearch);
    qEl.addEventListener('input', checkInputType);
    qEl.addEventListener('keydown', e => { if(e.key === 'Enter') performSearch(); });
    document.getElementById('settingsBtn').addEventListener('click', () => document.getElementById('overlay').style.display='flex');
    document.getElementById('closeSettingsBtn').addEventListener('click', () => document.getElementById('overlay').style.display='none');
    document.getElementById('saveSettingsBtn').addEventListener('click', saveConfig);
    document.getElementById('resetBtn').addEventListener('click', () => { if(confirm('Reset all settings?')){ localStorage.clear(); location.reload(); }});
    document.getElementById('clearBtn').addEventListener('click', () => { qEl.value=''; checkInputType(); });

    function checkInputType() {
        const val = qEl.value.trim();
        const isUrl = /^https?:\/\//i.test(val) || (val.includes('.') && !val.includes(' '));
        document.getElementById('summarizeBtn').style.display = isUrl ? 'block' : 'none';
    }

    function updateTheme() {
        document.documentElement.style.setProperty('--accent', BTN_COLOR);
        document.documentElement.style.setProperty('--button-bg', BTN_COLOR);
        meshBg.style.display = MESH_ENABLED ? 'block' : 'none';
        
        const rgb = BTN_COLOR.replace('#','');
        const lum = 0.21*parseInt(rgb.substr(0,2),16) + 0.72*parseInt(rgb.substr(2,2),16) + 0.07*parseInt(rgb.substr(4,2),16);
        document.documentElement.style.setProperty('--button-fg', lum > 160 ? '#000' : '#fff');
    }

    function saveConfig() {
        API_KEY = document.getElementById('apiKeyInput').value.trim();
        BTN_COLOR = document.getElementById('btnColor').value;
        MESH_ENABLED = meshSwitch.checked;
        
        localStorage.setItem(LS.key, API_KEY);
        localStorage.setItem(LS.color, BTN_COLOR);
        localStorage.setItem(LS.mesh, MESH_ENABLED);
        
        updateTheme();
        document.getElementById('overlay').style.display='none';
    }

    async function performSearch() {
        const q = qEl.value.trim();
        if(!q) return;

        if(/^https?:\/\//i.test(q) || (q.includes('.') && !q.includes(' '))) {
            window.location.href = q.startsWith('http') ? q : 'https://' + q;
            return;
        }

        addHistory(q);
        document.getElementById('logo').style.animation = 'meshAnim 2s infinite linear';
        document.getElementById('lamboResult').style.display = 'block';
        document.getElementById('googleResult').style.display = 'block';

        await fetchLamboAI(q);
        document.getElementById('logo').style.animation = 'logoPulse 4s infinite ease-in-out';
    }

    async function fetchLamboAI(q) {
        if(!API_KEY) { lamboTextEl.textContent = 'Please configure API Key in settings ‚öô'; return; }
        lamboTextEl.innerHTML = 'Thinking... <span class="typingCursor"></span>';
        
        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: `You are Lambo, a smart assistant. Context: Canadian English (en-CA). Respond to: ${q}. Be concise.` }] }] })
            });
            const data = await res.json();
            const text = data?.candidates?.[0]?.content?.parts?.[0]?.text || 'No response found.';
            await typeEffect(text);
        } catch(e) {
            lamboTextEl.textContent = 'Connection error. Check your API key.';
        }
    }

    function typeEffect(text) {
        return new Promise(resolve => {
            lamboTextEl.innerHTML = '';
            let i = 0;
            function next() {
                if(i < text.length) {
                    lamboTextEl.innerHTML += text[i++];
                    setTimeout(next, 8);
                } else resolve();
            }
            next();
        });
    }

    function addHistory(q) {
        HISTORY = HISTORY.filter(item => item.q !== q);
        HISTORY.unshift({ q, id: Date.now() });
        if(HISTORY.length > 5) HISTORY.pop();
        localStorage.setItem(LS.hist, JSON.stringify(HISTORY));
        renderHistory();
    }

    function renderHistory() {
        const hDiv = document.getElementById('history');
        if(HISTORY.length === 0) { hDiv.innerHTML = '<span style="color:#555">Clean slate.</span>'; return; }
        hDiv.innerHTML = HISTORY.map(item => `
            <div class="history-card">
                <span onclick="qEl.value='${item.q}';performSearch();" style="cursor:pointer; font-size:14px;">${item.q}</span>
                <span onclick="deleteItem(${item.id})" style="cursor:pointer; font-size:18px; opacity:0.3">√ó</span>
            </div>
        `).join('');
    }

    window.deleteItem = (id) => {
        HISTORY = HISTORY.filter(i => i.id !== id);
        localStorage.setItem(LS.hist, JSON.stringify(HISTORY));
        renderHistory();
    };
</script>
</body>
</html>
